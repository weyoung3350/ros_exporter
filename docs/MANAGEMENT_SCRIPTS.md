# ros_exporter ç®¡ç†è„šæœ¬

## ðŸ“‹ è„šæœ¬æ¦‚è¿°

ros_exporteræä¾›äº†ä¸‰ä¸ªç®¡ç†è„šæœ¬ï¼Œç”¨äºŽæ–¹ä¾¿åœ°ç®¡ç†æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸï¼š

### ðŸš€ **start.sh** - å¯åŠ¨è„šæœ¬
- **åŠŸèƒ½**: å¯åŠ¨ros_exporteræœåŠ¡
- **ç‰¹ç‚¹**: è‡ªåŠ¨æ£€æµ‹æž¶æž„ï¼ŒåŽå°è¿è¡Œï¼Œè®°å½•PID

### ðŸ”„ **restart.sh** - é‡å¯è„šæœ¬  
- **åŠŸèƒ½**: åœæ­¢å½“å‰è¿è¡Œçš„æœåŠ¡å¹¶é‡æ–°å¯åŠ¨
- **ç‰¹ç‚¹**: ä¼˜é›…åœæ­¢ + è‡ªåŠ¨å¯åŠ¨ï¼Œå®Œæ•´çš„çŠ¶æ€æ£€æŸ¥

### ðŸ›‘ **shutdown.sh** - å…³é—­è„šæœ¬
- **åŠŸèƒ½**: å®‰å…¨åœæ­¢ros_exporteræœåŠ¡
- **ç‰¹ç‚¹**: ä¼˜é›…å…³é—­ï¼Œå¯é€‰æ—¥å¿—æ¸…ç†ï¼Œå®Œæ•´çš„æ¸…ç†æµç¨‹

## ðŸ”§ ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨æœåŠ¡

```bash
# åŸºæœ¬å¯åŠ¨
./start.sh

# æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨
./start.sh -config custom.yaml

# æŒ‡å®šç½‘ç»œæŽ¥å£å¯åŠ¨
./start.sh -interfaces ens160
```

### é‡å¯æœåŠ¡

```bash
# é‡å¯æœåŠ¡
./restart.sh
```

**é‡å¯æµç¨‹**ï¼š
1. æ£€æŸ¥å½“å‰è¿è¡ŒçŠ¶æ€
2. ä¼˜é›…åœæ­¢çŽ°æœ‰è¿›ç¨‹
3. ç­‰å¾…è¿›ç¨‹å®Œå…¨é€€å‡º
4. å¯åŠ¨æ–°çš„æœåŠ¡å®žä¾‹
5. éªŒè¯å¯åŠ¨æˆåŠŸ

### å…³é—­æœåŠ¡

```bash
# æ­£å¸¸å…³é—­ï¼ˆä¿ç•™æ—¥å¿—ï¼‰
./shutdown.sh

# å…³é—­å¹¶æ¸…ç†æ—¥å¿—
./shutdown.sh --clean-logs

# æŸ¥çœ‹å¸®åŠ©
./shutdown.sh --help
```

**å…³é—­æµç¨‹**ï¼š
1. æ£€æŸ¥è¿è¡ŒçŠ¶æ€
2. æ˜¾ç¤ºå…³é—­å‰æ—¥å¿—
3. å‘é€TERMä¿¡å·ä¼˜é›…å…³é—­
4. ç­‰å¾…æœ€å¤š30ç§’
5. å¿…è¦æ—¶å¼ºåˆ¶ç»ˆæ­¢
6. æ¸…ç†PIDæ–‡ä»¶å’Œå¯é€‰æ—¥å¿—

## ðŸ“Š çŠ¶æ€ç®¡ç†

### è¿›ç¨‹ç®¡ç†

æ‰€æœ‰è„šæœ¬éƒ½æ”¯æŒï¼š
- **PIDæ–‡ä»¶ç®¡ç†** - ä½¿ç”¨`exporter.pid`è·Ÿè¸ªè¿›ç¨‹
- **å¤šé‡æ£€æµ‹** - é€šè¿‡PIDæ–‡ä»¶å’Œè¿›ç¨‹ååŒé‡ç¡®è®¤
- **ä¼˜é›…å…³é—­** - å‘é€TERMä¿¡å·ï¼Œç­‰å¾…ä¼˜é›…é€€å‡º
- **å¼ºåˆ¶ç»ˆæ­¢** - è¶…æ—¶åŽä½¿ç”¨KILLä¿¡å·

### æ—¥å¿—ç®¡ç†

- **æ—¥å¿—æ–‡ä»¶**: `exporter.log`
- **PIDæ–‡ä»¶**: `exporter.pid` 
- **è‡ªåŠ¨è½®è½¬**: æ¯æ¬¡å¯åŠ¨åˆ›å»ºæ–°æ—¥å¿—
- **å¯é€‰æ¸…ç†**: shutdown.shæ”¯æŒ`--clean-logs`å‚æ•°

### æž¶æž„è‡ªé€‚åº”

è„šæœ¬è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿæž¶æž„ï¼š
- **x86_64**: ä½¿ç”¨`ros_exporter-linux-amd64`
- **aarch64/arm64**: ä½¿ç”¨`ros_exporter-linux-arm64`

## ðŸŽ¨ è¾“å‡ºæ ·å¼

è„šæœ¬ä½¿ç”¨å½©è‰²è¾“å‡ºæé«˜å¯è¯»æ€§ï¼š
- ðŸ”µ **[INFO]** - ä¸€èˆ¬ä¿¡æ¯ï¼ˆè“è‰²ï¼‰
- ðŸŸ¢ **[SUCCESS]** - æˆåŠŸæ“ä½œï¼ˆç»¿è‰²ï¼‰
- ðŸŸ¡ **[WARNING]** - è­¦å‘Šä¿¡æ¯ï¼ˆé»„è‰²ï¼‰
- ðŸ”´ **[ERROR]** - é”™è¯¯ä¿¡æ¯ï¼ˆçº¢è‰²ï¼‰

## ðŸ“ ä½¿ç”¨ç¤ºä¾‹

### å…¸åž‹å·¥ä½œæµç¨‹

```bash
# 1. é¦–æ¬¡å¯åŠ¨
./start.sh

# 2. æ£€æŸ¥çŠ¶æ€
ps aux | grep ros_exporter

# 3. æŸ¥çœ‹æ—¥å¿—
tail -f exporter.log

# 4. é‡å¯æœåŠ¡ï¼ˆé…ç½®æ›´æ–°åŽï¼‰
./restart.sh

# 5. æ­£å¸¸å…³é—­
./shutdown.sh
```

### æ•…éšœæŽ’é™¤

```bash
# å¦‚æžœå¯åŠ¨å¤±è´¥ï¼ŒæŸ¥çœ‹è¯¦ç»†æ—¥å¿—
cat exporter.log

# å¼ºåˆ¶æ¸…ç†æ‰€æœ‰æ®‹ç•™è¿›ç¨‹
./shutdown.sh
pkill -f ros_exporter

# é‡æ–°å¯åŠ¨
./start.sh
```

### æœåŠ¡åŒ–éƒ¨ç½²

```bash
# åˆ›å»ºsystemdæœåŠ¡æ–‡ä»¶
sudo tee /etc/systemd/system/ros_exporter.service > /dev/null <<EOF
[Unit]
Description=ros_exporter
After=network.target

[Service]
Type=forking
User=dna
WorkingDirectory=/home/dna/ros_exporter-1.0.0
ExecStart=/home/dna/ros_exporter-1.0.0/start.sh
ExecReload=/home/dna/ros_exporter-1.0.0/restart.sh
ExecStop=/home/dna/ros_exporter-1.0.0/shutdown.sh
PIDFile=/home/dna/ros_exporter-1.0.0/exporter.pid
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
EOF

# å¯ç”¨å¹¶å¯åŠ¨æœåŠ¡
sudo systemctl daemon-reload
sudo systemctl enable ros_exporter
sudo systemctl start ros_exporter

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status ros_exporter
```

## ðŸ” è„šæœ¬ç‰¹æ€§

### restart.sh ç‰¹æ€§

- âœ… **æ™ºèƒ½æ£€æµ‹**: è‡ªåŠ¨æ£€æµ‹å¯æ‰§è¡Œæ–‡ä»¶æž¶æž„
- âœ… **çŠ¶æ€éªŒè¯**: å¯åŠ¨å‰åŽéƒ½è¿›è¡ŒçŠ¶æ€æ£€æŸ¥
- âœ… **ä¼˜é›…é‡å¯**: å…ˆåœæ­¢å†å¯åŠ¨ï¼Œé¿å…ç«¯å£å†²çª
- âœ… **é”™è¯¯å¤„ç†**: å®Œæ•´çš„é”™è¯¯æ£€æŸ¥å’Œæ—¥å¿—è®°å½•
- âœ… **è¿›åº¦æ˜¾ç¤º**: å®žæ—¶æ˜¾ç¤ºé‡å¯è¿›åº¦

### shutdown.sh ç‰¹æ€§

- âœ… **ä¼˜é›…å…³é—­**: 30ç§’ä¼˜é›…å…³é—­çª—å£
- âœ… **å¼ºåˆ¶ç»ˆæ­¢**: è¶…æ—¶åŽè‡ªåŠ¨å¼ºåˆ¶ç»ˆæ­¢
- âœ… **å®Œæ•´æ¸…ç†**: æ¸…ç†PIDæ–‡ä»¶å’Œå¯é€‰æ—¥å¿—
- âœ… **çŠ¶æ€éªŒè¯**: ç¡®è®¤æœåŠ¡å®Œå…¨åœæ­¢
- âœ… **æ—¥å¿—ä¿ç•™**: é»˜è®¤ä¿ç•™æ—¥å¿—ï¼Œå¯é€‰æ¸…ç†

### é€šç”¨ç‰¹æ€§

- âœ… **å½©è‰²è¾“å‡º**: æ¸…æ™°çš„çŠ¶æ€æŒ‡ç¤º
- âœ… **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯æ£€æŸ¥æœºåˆ¶
- âœ… **ä¿¡å·å¤„ç†**: æ”¯æŒCtrl+Cä¸­æ–­
- âœ… **å¸®åŠ©ä¿¡æ¯**: å†…ç½®å¸®åŠ©å’Œä½¿ç”¨è¯´æ˜Ž

## ðŸš¨ æ³¨æ„äº‹é¡¹

1. **æƒé™è¦æ±‚**: è„šæœ¬éœ€è¦æ‰§è¡Œæƒé™ (`chmod +x *.sh`)
2. **é…ç½®æ–‡ä»¶**: ç¡®ä¿`config.yaml`å­˜åœ¨ä¸”é…ç½®æ­£ç¡®
3. **ç½‘ç»œè¿žæŽ¥**: ç¡®ä¿VictoriaMetricsæœåŠ¡å¯è¾¾
4. **èµ„æºç›‘æŽ§**: å®šæœŸæ£€æŸ¥ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
5. **æ—¥å¿—è½®è½¬**: é•¿æœŸè¿è¡Œå»ºè®®é…ç½®æ—¥å¿—è½®è½¬

## ðŸ”— ç›¸å…³æ–‡ä»¶

- `config.yaml` - ä¸»é…ç½®æ–‡ä»¶
- `config.example.yaml` - é…ç½®æ¨¡æ¿
- `exporter.log` - è¿è¡Œæ—¥å¿—
- `exporter.pid` - è¿›ç¨‹IDæ–‡ä»¶
- `ros_exporter-linux-*` - å¯æ‰§è¡Œæ–‡ä»¶

## ðŸ“ž æ•…éšœæ”¯æŒ

å¦‚æžœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥`exporter.log`æ—¥å¿—æ–‡ä»¶
2. ç¡®è®¤é…ç½®æ–‡ä»¶è¯­æ³•æ­£ç¡®
3. éªŒè¯ç½‘ç»œè¿žæŽ¥åˆ°VictoriaMetrics
4. æ£€æŸ¥ç³»ç»Ÿèµ„æºæ˜¯å¦å……è¶³
5. ç¡®è®¤å¯æ‰§è¡Œæ–‡ä»¶æƒé™æ­£ç¡®

**æ³¨æ„ï¼šæ‰€æœ‰ç®¡ç†è„šæœ¬éƒ¨ç½²åŽä¸Žä¸»ç¨‹åºåŒçº§ï¼Œç›´æŽ¥ç”¨ `./start.sh` æ–¹å¼è°ƒç”¨ã€‚** 